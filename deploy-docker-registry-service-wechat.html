<html>
  <head>
    <meta http-equiv=Content-Type content="text/html;charset=utf-8">
    <link rel="stylesheet" href="theme/css/wechat.css" type="text/css" charset="utf-8">
  </head>
  <body>
    <p>使用 Docker 时，很多情况下需要搭建自己的 registry 服务。把一些私有的 Image 放到上面用。官方有一个 registry 的<a href="https://hub.docker.com/_/registry/">镜像</a>可以拉下来，直接用。如下：</p>
<pre class="codehilite"><code>docker run -p 5000:5000 -v &lt;HOST_DIR&gt;:/tmp/registry-dev registry</code></pre>


<p>但是默认没有加上 ssl(如果没有，只能给本机提供服务)， proxy也没有开启。</p>
<p>我自己写了一个 docker compose, 默认开启了以上两个功能，代码见<a href="https://github.com/jeffrey4l/docker-registry">这里</a>。默认使用了 host 的 /data/docker-registry/data 目录做数据 volume, 所以请保证这个目录存在。</p>
<p>使用自己建立的 registry 服务时，要修改 docker 的服务启动脚本，加上如下参数：</p>
<pre class="codehilite"><code>--insecure-registry your.domain.com:5000 --registry-mirror=https://your.domain.com:5000</code></pre>


<h1 id="ref">REF</h1>
<ul>
<li>https://github.com/jeffrey4l/docker-registry</li>
<li>https://github.com/docker/distribution/blob/master/docs/mirror.md</li>
<li>https://hub.docker.com/_/registry/</li>
</ul>
    <p> 点击「阅读原文」，能看到更好的排版。 </p>
    <!--
      <div class="copyleft">
      <p>文档信息</p>
      <ul>
      <li> 版权声明：自由转载-非商用-非衍生-保持署名（创意共享3.0许可证）</li>
      <li> 作者： Jeffrey4l </li>
      <li> 发表日期： 2017年12月19日 </li>
      </div>
    -->
  </body>
</html>
