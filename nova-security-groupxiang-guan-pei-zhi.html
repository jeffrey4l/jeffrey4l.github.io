<!DOCTYPE html>
<html lang="cn">
<head>
          <title> Nova Security Group相关配置 - Xcodest </title>
        <meta charset="utf-8" />



    <meta name="tags" contents="Network" />

        <link rel="stylesheet" href="http://xcodest.me/theme/css/bootstrap.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="http://xcodest.me/theme/css/pygment.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="http://xcodest.me/theme/css/main.css" type="text/css" charset="utf-8">
        <link rel="icon" type="image/png" href="http://xcodest.me/theme/img/favicon.ico">
</head>

<body id="index" class="home">
    <div class="container">
        <header id="banner" class="body">
                <span class='site-title'><a href="http://xcodest.me/">Xcodest</a></span><span class="site-subtitle">code for fun</span>
        </header>
<section id="content" class="body">
  <header>
    <h2 class="entry-title">Nova Security Group相关配置</h2>
    <span class="post-date"> 2015-03-18 </span>
  </header>
  <div class="entry-content">
    <h1>相关配置</h1>
<ul>
<li>network_api_class - 设置 network 模块所用的api<ul>
<li><code>nova.network.api.API</code> - 通过rpc与nova-network交互</li>
<li><code>nova.network.neutronv2.API</code> - 通过http与neutron-server交互</li>
</ul>
</li>
<li>security_group_api - 设置 security group 模块所用的api类<ul>
<li><code>nova</code> (<code>nova.compute.api.SecurityGroupAPI</code>) - 通过rcp与nova-compute交互</li>
<li><code>neutron</code> ( <code>nova.network.security_group.neutron_driver.SecurityGroupAPI</code> ) - 通过http与neutron-server交互</li>
</ul>
</li>
<li>linuxnet_interface_driver - 在机器与 ethernet interface plug&amp;unplug时调用 。<ul>
<li><code>nova.network.linux_net.LinuxBridgeInterfaceDriver</code> - used in nova-network</li>
<li><code>nova.network.linux_net.linuxOVSInterfaceDriver</code> - use in neutron + ml2 + ovs</li>
<li><code>nova.network.linux_net.NeutronLinuxBridgeInterfaceDriver</code> - use in neutron + ml2 + linuxbridge</li>
</ul>
</li>
<li>firewall_driver - 虚拟化层所用的 firewall。在nova-network时代，security group由iptables和ebtables实现。在neutron时代，这个已经不需要了。但是neutron里现在还有arp-spoofing的bug, 参见[2]<ul>
<li><code>nova.virt.firewall.IptablesFirewallDrive</code> - </li>
<li><code>nova.virt.firewall.NoopFirewallDriver</code></li>
</ul>
</li>
</ul>
<h1>使用组合：</h1>
<p>nova-network + libvirt</p>
<div class="highlight"><pre>nova_api_class=nova.network.api.API
security_group_ap=nova
linuxnet_interface_driver=nova.network.linux_net.LinuxBridgeInterfaceDriver
firewall_driver=nova.virt.firewall.IptablesFirewallDrive
</pre></div>


<p>neutron + ml2 + linuxbridge plugin + libvirt</p>
<div class="highlight"><pre>nova_api_class=nova.network.neutronv2.API
security_group_ap=neutron
linuxnet_interface_driver=nova.network.linux_net.NeutronLinuxBridgeInterfaceDriver
firewall_driver=nova.virt.firewall.NoopFirewallDriver
</pre></div>


<p>neutron + ml2 + ovs plugin + libvirt</p>
<div class="highlight"><pre>nova_api_class=nova.network.neutronv2.API
security_group_ap=neutron
linuxnet_interface_driver=nova.network.linux_net.linuxOVSInterfaceDriver
firewall_driver=nova.virt.firewall.NoopFirewallDriver
</pre></div>


<h1>REF</h1>
<ol>
<li><a href="http://kennethjiang.blogspot.jp/2012/02/ebtables-in-openstack-nova-and.html">ebtables in Openstack Nova</a> - nwfilter explaination</li>
<li><a href="https://blueprints.launchpad.net/neutron/+spec/arp-spoof-patch-ebtables">Preventing ARP spoofing via ebtables</a> - Neutron BP for preventing arp snoofing. Expected in Kilo<ol>
<li><a href="https://bugs.launchpad.net/neutron/+bug/1274034">Neutron firewall anti-spoofing does not prevent ARP poisoning</a> - Related bug</li>
</ol>
</li>
</ol>
  </div><!-- /.entry-content -->
  <div class="entry-info">
    <p> Tags: <a href="http://xcodest.me/tag/network.html">Network</a>  </p>
  </div>
    <div class="comments">
      <h2>Comments</h2>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        var disqus_shortname = 'xcodest';
        var disqus_identifier = 'nova-security-groupxiang-guan-pei-zhi.html';
        var disqus_url = 'http://xcodest.me/nova-security-groupxiang-guan-pei-zhi.html';
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//xcodest.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
      <noscript>Please enable JavaScript to view the comments.</noscript>
    </div>
</section>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-41808584-2']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
    </div>
</body>
</html>